#!/usr/bin/env python

# store all of the traffic packets in a queue in order to prevent it to get to the router (dest)
# iptables -I FORWARD -j NFQUEUE --queue-num 0
# when we check our own machine, instead of FORWARD, use OUTPUT and then INPUT
# make sure to delete the iptables by: iptables --flush
# pip install netfilterqueue

import netfilterqueue

def process_packet(packet)
    print(packet)
    #packet.accept() #pass the packets forward
    packet.drop() #cut the connection by dropping the packets

#trap all the packets in a queue:
queue = netfilterqueue.NetfilterQueue()
#connect the queue object with the queue we have created earlier:
queue.bind(0, process_packet)
# the 0 is the queue number which we defined in the linux machine
# process_packet - callback function to be executed on each packet
queue.run()
